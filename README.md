
# Packer - ELF File Obfuscator

`packer` — это инструмент для обфускации и модификации ELF-файлов. Он поддерживает несколько техник, таких как:

- Шифрование строк с помощью XOR.
- Инъекция NOP-ов в секцию `.text`.

## Возможности

1. **Шифрование строк в секции `.rodata`:**
   - Использует простой XOR с заданным ключом для шифрования строк в ELF-файле.

2. **Инъекция NOP-ов в секцию `.text`:**
   - Вставка NOP-инструкций в начало или в произвольные адреса секции `.text`.
   - Заполнение конца секции NOP-ами.

## Установка

Для сборки проекта требуется установить зависимости:

- [ELFIO](https://github.com/elfio/elfio) — библиотека для работы с ELF-файлами.
- [Keystone](https://www.keystone-engine.org/) — ассемблер для генерации машинного кода.

### Сборка

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/And-oss/packer.git
   cd packer
   ```

2. Установите зависимости (например, с помощью `git`):

   ```bash
   git clone https://github.com/keystone-engine/keystone
   git clone https://github.com/serge1/ELFIO
   ```

3. Скомпилируйте проект:

   ```bash
   g++ packer.cpp -o packer -lkeystone 
   ```

## Использование

### Основной синтаксис

```bash
./packer -f <filename> [options]
```

### Параметры

- `-f <filename>` — путь к ELF-файлу для обработки (обязательный параметр).
- `-h` — выводит справку о параметрах.
- `-ni` — инъекция NOP-ов в секцию `.text`.
- `-s` — шифрование строк в секции `.rodata`.
- `-k <key>` — ключ для шифрования строк (XOR-ключ, в шестнадцатеричной форме).
- `-addr <address>` — адрес для инъекции NOP-ов (по умолчанию инъекция в начало).
- `-end` — заполняет конец секции `.text` NOP-ами.

### Примеры

1. **Шифрование строк в секции `.rodata` с ключом `0xAA`:**

   ```bash
   ./packer -f my_binary -s -k 0xAA
   ```

2. **Инъекция 10 NOP-ов в начало секции `.text`:**

   ```bash
   ./packer -f my_binary -ni
   ```

3. **Инъекция 5 NOP-ов по адресу `0x401000` в секции `.text`:**

   ```bash
   ./packer -f my_binary -ni -addr 0x401000 -k 0x55
   ```

4. **Заполнение конца секции `.text` NOP-ами:**

   ```bash
   ./packer -f my_binary -ni -end
   ```

5. **Комбинированное использование:**

   ```bash
   ./packer -f my_binary -ni -addr 0x401050 -end -s -k 0x42
   ```

   В этом примере: инъекция NOP-ов по адресу `0x401050`, очистка конца секции `.text` и шифрование строк с ключом `0x42`.
